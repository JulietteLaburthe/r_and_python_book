<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Reshaping and Combining Data Sets | An Introduction to R and Python For Data Analysis: A Side By Side Approach</title>
  <meta name="description" content="Chapter 10 Reshaping and Combining Data Sets | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Reshaping and Combining Data Sets | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="tbrown122387/r_and_python_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Reshaping and Combining Data Sets | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  
  
  

<meta name="author" content="Taylor R. Brown" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="control-flow.html"/>
<link rel="next" href="visualization.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction to R and Python For Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-sample-course"><i class="fa fa-check"></i>A Sample Course</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licenses"><i class="fa fa-check"></i>License(s)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-the-required-software"><i class="fa fa-check"></i>Installing the Required Software</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-r-and-rstudio"><i class="fa fa-check"></i>Installing R (and RStudio)</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-python-by-installing-anaconda"><i class="fa fa-check"></i>Installing Python by Installing Anaconda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#part-introducing-the-basics"><i class="fa fa-check"></i>(PART) Introducing the Basics</a>
<ul>
<li class="chapter" data-level="0.1" data-path="preface.html"><a href="preface.html#hello-world-in-r"><i class="fa fa-check"></i><b>0.1</b> Hello World in R</a></li>
<li class="chapter" data-level="0.2" data-path="preface.html"><a href="preface.html#hello-world-in-python"><i class="fa fa-check"></i><b>0.2</b> Hello World in Python</a></li>
<li class="chapter" data-level="0.3" data-path="preface.html"><a href="preface.html#getting-help"><i class="fa fa-check"></i><b>0.3</b> Getting Help</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path="preface.html"><a href="preface.html#reading-documentation"><i class="fa fa-check"></i><b>0.3.1</b> Reading Documentation</a></li>
<li class="chapter" data-level="0.3.2" data-path="preface.html"><a href="preface.html#understanding-file-paths"><i class="fa fa-check"></i><b>0.3.2</b> Understanding File Paths</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="basic-types.html"><a href="basic-types.html"><i class="fa fa-check"></i><b>1</b> Basic Types</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basic-types.html"><a href="basic-types.html#basic-types-in-python"><i class="fa fa-check"></i><b>1.1</b> Basic Types In Python</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="basic-types.html"><a href="basic-types.html#type-conversions-in-python"><i class="fa fa-check"></i><b>1.1.1</b> Type Conversions in Python</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="basic-types.html"><a href="basic-types.html#basic-types-in-r"><i class="fa fa-check"></i><b>1.2</b> Basic Types In R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="basic-types.html"><a href="basic-types.html#type-conversions-in-r"><i class="fa fa-check"></i><b>1.2.1</b> Type Conversions in R</a></li>
<li class="chapter" data-level="1.2.2" data-path="basic-types.html"><a href="basic-types.html#rs-simplification"><i class="fa fa-check"></i><b>1.2.2</b> R’s Simplification</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="basic-types.html"><a href="basic-types.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="basic-types.html"><a href="basic-types.html#r-questions"><i class="fa fa-check"></i><b>1.3.1</b> R Questions</a></li>
<li class="chapter" data-level="1.3.2" data-path="basic-types.html"><a href="basic-types.html#python-questions"><i class="fa fa-check"></i><b>1.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html"><i class="fa fa-check"></i><b>2</b> R <code>vector</code>s versus Numpy <code>array</code>s and Pandas’ <code>Series</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#overview-of-r"><i class="fa fa-check"></i><b>2.1</b> Overview of R</a></li>
<li class="chapter" data-level="2.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#overview-of-python"><i class="fa fa-check"></i><b>2.2</b> Overview of Python</a></li>
<li class="chapter" data-level="2.3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-r"><i class="fa fa-check"></i><b>2.3</b> Vectorization in R</a></li>
<li class="chapter" data-level="2.4" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-python"><i class="fa fa-check"></i><b>2.4</b> Vectorization in Python</a></li>
<li class="chapter" data-level="2.5" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-vectors-in-r"><i class="fa fa-check"></i><b>2.5</b> Indexing Vectors in R</a></li>
<li class="chapter" data-level="2.6" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-numpy-arrays"><i class="fa fa-check"></i><b>2.6</b> Indexing Numpy arrays</a></li>
<li class="chapter" data-level="2.7" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-pandas-series"><i class="fa fa-check"></i><b>2.7</b> Indexing Pandas’ Series</a></li>
<li class="chapter" data-level="2.8" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#some-gotchas"><i class="fa fa-check"></i><b>2.8</b> Some Gotchas</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#shallow-versus-deep-copies"><i class="fa fa-check"></i><b>2.8.1</b> Shallow versus Deep Copies</a></li>
<li class="chapter" data-level="2.8.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#how-r-and-python-handle-missing-values"><i class="fa fa-check"></i><b>2.8.2</b> How R and Python Handle Missing Values</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#r-questions-1"><i class="fa fa-check"></i><b>2.9.1</b> R Questions</a></li>
<li class="chapter" data-level="2.9.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#python-questions-1"><i class="fa fa-check"></i><b>2.9.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><i class="fa fa-check"></i><b>3</b> Numpy <code>ndarray</code>s Versus R’s <code>matrix</code> and <code>array</code> Types</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#numpy-ndarrays-in-python"><i class="fa fa-check"></i><b>3.1</b> Numpy <code>ndarray</code>s In Python</a></li>
<li class="chapter" data-level="3.2" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#the-matrix-and-array-classes-in-r"><i class="fa fa-check"></i><b>3.2</b> The <code>matrix</code> and <code>array</code> classes in R</a></li>
<li class="chapter" data-level="3.3" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#exercises-2"><i class="fa fa-check"></i><b>3.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#r-questions-2"><i class="fa fa-check"></i><b>3.3.1</b> R Questions</a></li>
<li class="chapter" data-level="3.3.2" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#python-questions-2"><i class="fa fa-check"></i><b>3.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html"><i class="fa fa-check"></i><b>4</b> R’s <code>list</code>s Versus Python’s <code>list</code>s and <code>dict</code>s</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#lists-in-r"><i class="fa fa-check"></i><b>4.1</b> <code>list</code>s In R</a></li>
<li class="chapter" data-level="4.2" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#lists-in-python"><i class="fa fa-check"></i><b>4.2</b> <code>list</code>s In Python</a></li>
<li class="chapter" data-level="4.3" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#dictionaries-in-python"><i class="fa fa-check"></i><b>4.3</b> Dictionaries In Python</a></li>
<li class="chapter" data-level="4.4" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#exercises-3"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#r-questions-3"><i class="fa fa-check"></i><b>4.4.1</b> R Questions</a></li>
<li class="chapter" data-level="4.4.2" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#python-questions-3"><i class="fa fa-check"></i><b>4.4.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#defining-r-functions"><i class="fa fa-check"></i><b>5.1</b> Defining R Functions</a></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#defining-python-functions"><i class="fa fa-check"></i><b>5.2</b> Defining Python Functions</a></li>
<li class="chapter" data-level="5.3" data-path="functions.html"><a href="functions.html#more-details-on-rs-user-defined-functions"><i class="fa fa-check"></i><b>5.3</b> More Details On R’s User-Defined Functions</a></li>
<li class="chapter" data-level="5.4" data-path="functions.html"><a href="functions.html#more-details-on-pythons-user-defined-functions"><i class="fa fa-check"></i><b>5.4</b> More details on Python’s user-defined functions</a></li>
<li class="chapter" data-level="5.5" data-path="functions.html"><a href="functions.html#function-scope-in-r"><i class="fa fa-check"></i><b>5.5</b> Function Scope in R</a></li>
<li class="chapter" data-level="5.6" data-path="functions.html"><a href="functions.html#function-scope-in-python"><i class="fa fa-check"></i><b>5.6</b> Function Scope in Python</a></li>
<li class="chapter" data-level="5.7" data-path="functions.html"><a href="functions.html#modifying-a-functions-arguments"><i class="fa fa-check"></i><b>5.7</b> Modifying a Function’s Arguments</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="functions.html"><a href="functions.html#passing-by-value-in-r"><i class="fa fa-check"></i><b>5.7.1</b> Passing By Value In R</a></li>
<li class="chapter" data-level="5.7.2" data-path="functions.html"><a href="functions.html#passing-by-assignment-in-python"><i class="fa fa-check"></i><b>5.7.2</b> Passing By Assignment In Python</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="functions.html"><a href="functions.html#accessing-and-modifying-captured-variables"><i class="fa fa-check"></i><b>5.8</b> Accessing and Modifying Captured Variables</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="functions.html"><a href="functions.html#accessing-captured-variables-in-r"><i class="fa fa-check"></i><b>5.8.1</b> Accessing Captured Variables in R</a></li>
<li class="chapter" data-level="5.8.2" data-path="functions.html"><a href="functions.html#accessing-captured-variables-in-python"><i class="fa fa-check"></i><b>5.8.2</b> Accessing Captured Variables in Python</a></li>
<li class="chapter" data-level="5.8.3" data-path="functions.html"><a href="functions.html#modifying-captured-variables-in-r"><i class="fa fa-check"></i><b>5.8.3</b> Modifying Captured Variables In R</a></li>
<li class="chapter" data-level="5.8.4" data-path="functions.html"><a href="functions.html#modifying-captured-variables-in-python"><i class="fa fa-check"></i><b>5.8.4</b> Modifying Captured Variables In Python</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="functions.html"><a href="functions.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="functions.html"><a href="functions.html#r-questions-4"><i class="fa fa-check"></i><b>5.9.1</b> R Questions</a></li>
<li class="chapter" data-level="5.9.2" data-path="functions.html"><a href="functions.html#python-questions-4"><i class="fa fa-check"></i><b>5.9.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>6</b> Categorical Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="categorical-data.html"><a href="categorical-data.html#factors-in-r"><i class="fa fa-check"></i><b>6.1</b> <code>factor</code>s in R</a></li>
<li class="chapter" data-level="6.2" data-path="categorical-data.html"><a href="categorical-data.html#two-options-for-categorical-data-in-pandas"><i class="fa fa-check"></i><b>6.2</b> Two Options for Categorical Data in Pandas</a></li>
<li class="chapter" data-level="6.3" data-path="categorical-data.html"><a href="categorical-data.html#exercises-5"><i class="fa fa-check"></i><b>6.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="categorical-data.html"><a href="categorical-data.html#r-questions-5"><i class="fa fa-check"></i><b>6.3.1</b> R Questions</a></li>
<li class="chapter" data-level="6.3.2" data-path="categorical-data.html"><a href="categorical-data.html#python-questions-5"><i class="fa fa-check"></i><b>6.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>7</b> Data Frames</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-r"><i class="fa fa-check"></i><b>7.1</b> Data Frames in R</a></li>
<li class="chapter" data-level="7.2" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-python"><i class="fa fa-check"></i><b>7.2</b> Data Frames in Python</a></li>
<li class="chapter" data-level="7.3" data-path="data-frames.html"><a href="data-frames.html#exercises-6"><i class="fa fa-check"></i><b>7.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="data-frames.html"><a href="data-frames.html#r-questions-6"><i class="fa fa-check"></i><b>7.3.1</b> R Questions</a></li>
<li class="chapter" data-level="7.3.2" data-path="data-frames.html"><a href="data-frames.html#python-questions-6"><i class="fa fa-check"></i><b>7.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#part-common-tasks-and-patterns"><i class="fa fa-check"></i>(PART) Common Tasks and Patterns</a>
<ul>
<li class="chapter" data-level="7.4" data-path="data-frames.html"><a href="data-frames.html#general-input-considerations"><i class="fa fa-check"></i><b>7.4</b> General Input Considerations</a></li>
<li class="chapter" data-level="7.5" data-path="data-frames.html"><a href="data-frames.html#reading-in-text-files-with-r"><i class="fa fa-check"></i><b>7.5</b> Reading in Text Files with R</a></li>
<li class="chapter" data-level="7.6" data-path="data-frames.html"><a href="data-frames.html#reading-in-text-files-with-pandas"><i class="fa fa-check"></i><b>7.6</b> Reading in Text Files with Pandas</a></li>
<li class="chapter" data-level="7.7" data-path="data-frames.html"><a href="data-frames.html#saving-data-in-r"><i class="fa fa-check"></i><b>7.7</b> Saving Data in R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="data-frames.html"><a href="data-frames.html#writing-out-tabular-plain-text-data-in-r"><i class="fa fa-check"></i><b>7.7.1</b> Writing Out Tabular Plain Text Data in R</a></li>
<li class="chapter" data-level="7.7.2" data-path="data-frames.html"><a href="data-frames.html#serialization-in-r"><i class="fa fa-check"></i><b>7.7.2</b> Serialization in R</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="data-frames.html"><a href="data-frames.html#saving-data-in-python"><i class="fa fa-check"></i><b>7.8</b> Saving Data in Python</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="data-frames.html"><a href="data-frames.html#writing-out-tabular-plain-text-data-in-python"><i class="fa fa-check"></i><b>7.8.1</b> Writing Out Tabular Plain Text Data in Python</a></li>
<li class="chapter" data-level="7.8.2" data-path="data-frames.html"><a href="data-frames.html#serialization-in-python"><i class="fa fa-check"></i><b>7.8.2</b> Serialization in Python</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="data-frames.html"><a href="data-frames.html#exercises-7"><i class="fa fa-check"></i><b>7.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="data-frames.html"><a href="data-frames.html#r-questions-7"><i class="fa fa-check"></i><b>7.9.1</b> R Questions</a></li>
<li class="chapter" data-level="7.9.2" data-path="data-frames.html"><a href="data-frames.html#python-questions-7"><i class="fa fa-check"></i><b>7.9.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="using-third-party-code.html"><a href="using-third-party-code.html"><i class="fa fa-check"></i><b>8</b> Using Third-Party Code</a>
<ul>
<li class="chapter" data-level="8.1" data-path="using-third-party-code.html"><a href="using-third-party-code.html#installing-packages-in-r"><i class="fa fa-check"></i><b>8.1</b> Installing Packages In R</a></li>
<li class="chapter" data-level="8.2" data-path="using-third-party-code.html"><a href="using-third-party-code.html#installing-packages-in-python"><i class="fa fa-check"></i><b>8.2</b> Installing Packages In Python</a></li>
<li class="chapter" data-level="8.3" data-path="using-third-party-code.html"><a href="using-third-party-code.html#loading-packages-in-r"><i class="fa fa-check"></i><b>8.3</b> Loading Packages In R</a></li>
<li class="chapter" data-level="8.4" data-path="using-third-party-code.html"><a href="using-third-party-code.html#loading-packages-in-python"><i class="fa fa-check"></i><b>8.4</b> Loading Packages In Python</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="using-third-party-code.html"><a href="using-third-party-code.html#importing-examples"><i class="fa fa-check"></i><b>8.4.1</b> <code>import</code>ing Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>9</b> Control Flow</a>
<ul>
<li class="chapter" data-level="9.1" data-path="control-flow.html"><a href="control-flow.html#conditional-logic"><i class="fa fa-check"></i><b>9.1</b> Conditional Logic</a></li>
<li class="chapter" data-level="9.2" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i><b>9.2</b> Loops</a></li>
<li class="chapter" data-level="9.3" data-path="control-flow.html"><a href="control-flow.html#exercises-8"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html"><i class="fa fa-check"></i><b>10</b> Reshaping and Combining Data Sets</a>
<ul>
<li class="chapter" data-level="10.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#ordering-and-sorting-data"><i class="fa fa-check"></i><b>10.1</b> Ordering and Sorting Data</a></li>
<li class="chapter" data-level="10.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#stacking-data-sets-and-placing-them-shoulder-to-shoulder"><i class="fa fa-check"></i><b>10.2</b> Stacking Data Sets and Placing Them Shoulder to Shoulder</a></li>
<li class="chapter" data-level="10.3" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#merging-or-joining-data-sets"><i class="fa fa-check"></i><b>10.3</b> Merging or Joining Data Sets</a></li>
<li class="chapter" data-level="10.4" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-data"><i class="fa fa-check"></i><b>10.4</b> Long Versus Wide Data</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-in-r"><i class="fa fa-check"></i><b>10.4.1</b> Long Versus Wide in R</a></li>
<li class="chapter" data-level="10.4.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-in-python"><i class="fa fa-check"></i><b>10.4.2</b> Long Versus Wide in Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>11</b> Visualization</a>
<ul>
<li class="chapter" data-level="11.1" data-path="visualization.html"><a href="visualization.html#base-r-plotting"><i class="fa fa-check"></i><b>11.1</b> Base R Plotting</a></li>
<li class="chapter" data-level="11.2" data-path="visualization.html"><a href="visualization.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>11.2</b> Plotting with <code>ggplot2</code></a></li>
<li class="chapter" data-level="11.3" data-path="visualization.html"><a href="visualization.html#plotting-with-matplotlib"><i class="fa fa-check"></i><b>11.3</b> Plotting with Matplotlib</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="working-with-text-data.html"><a href="working-with-text-data.html"><i class="fa fa-check"></i><b>12</b> Working With Text Data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="working-with-text-data.html"><a href="working-with-text-data.html#an-introducton-to-regular-expressions"><i class="fa fa-check"></i><b>12.1</b> An Introducton to Regular Expressions</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="working-with-text-data.html"><a href="working-with-text-data.html#literal-characters-versus-metacharacters"><i class="fa fa-check"></i><b>12.1.1</b> Literal Characters versus Metacharacters</a></li>
<li class="chapter" data-level="12.1.2" data-path="working-with-text-data.html"><a href="working-with-text-data.html#the-trouble-with-backslashes-escape-sequences"><i class="fa fa-check"></i><b>12.1.2</b> The Trouble With Backslashes: Escape Sequences</a></li>
<li class="chapter" data-level="12.1.3" data-path="working-with-text-data.html"><a href="working-with-text-data.html#more-examples-of-using-regular-expressions"><i class="fa fa-check"></i><b>12.1.3</b> More Examples of Using Regular Expressions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>13</b> Dates and Times</a></li>
<li class="chapter" data-level="14" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html"><i class="fa fa-check"></i><b>14</b> Running Scripts from the Command Line</a></li>
<li class="chapter" data-level="" data-path=""><a href="#part-programming-styles"><i class="fa fa-check"></i>(PART) Programming Styles</a>
<ul>
<li class="chapter" data-level="14.1" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#oop-in-python"><i class="fa fa-check"></i><b>14.1</b> OOP In Python</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#overview"><i class="fa fa-check"></i><b>14.1.1</b> Overview</a></li>
<li class="chapter" data-level="14.1.2" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#a-first-example"><i class="fa fa-check"></i><b>14.1.2</b> A First Example</a></li>
<li class="chapter" data-level="14.1.3" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#adding-inheritance"><i class="fa fa-check"></i><b>14.1.3</b> Adding Inheritance</a></li>
<li class="chapter" data-level="14.1.4" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#adding-in-composition"><i class="fa fa-check"></i><b>14.1.4</b> Adding in Composition</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#oop-in-r"><i class="fa fa-check"></i><b>14.2</b> OOP In R</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#s3-objects-the-big-picture"><i class="fa fa-check"></i><b>14.2.1</b> S3 objects: The Big Picture</a></li>
<li class="chapter" data-level="14.2.2" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#using-s3-objects"><i class="fa fa-check"></i><b>14.2.2</b> Using S3 objects</a></li>
<li class="chapter" data-level="14.2.3" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#creating-s3-objects"><i class="fa fa-check"></i><b>14.2.3</b> Creating S3 objects</a></li>
<li class="chapter" data-level="14.2.4" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#s4-objects-the-big-picture"><i class="fa fa-check"></i><b>14.2.4</b> S4 objects: The Big Picture</a></li>
<li class="chapter" data-level="14.2.5" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#using-s4-objects"><i class="fa fa-check"></i><b>14.2.5</b> Using S4 objects</a></li>
<li class="chapter" data-level="14.2.6" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#creating-s4-objects"><i class="fa fa-check"></i><b>14.2.6</b> Creating S4 objects</a></li>
<li class="chapter" data-level="14.2.7" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#reference-classes-the-big-picture"><i class="fa fa-check"></i><b>14.2.7</b> Reference Classes: The Big Picture</a></li>
<li class="chapter" data-level="14.2.8" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#creating-reference-classes"><i class="fa fa-check"></i><b>14.2.8</b> Creating Reference Classes</a></li>
<li class="chapter" data-level="14.2.9" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#creating-r6-classes"><i class="fa fa-check"></i><b>14.2.9</b> Creating R6 Classes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="running-scripts-from-the-command-line.html"><a href="running-scripts-from-the-command-line.html#exercises-9"><i class="fa fa-check"></i><b>14.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="functional-programming.html"><a href="functional-programming.html"><i class="fa fa-check"></i><b>15</b> Functional Programming</a>
<ul>
<li class="chapter" data-level="15.1" data-path="functional-programming.html"><a href="functional-programming.html#functions-as-function-inputs-in-r"><i class="fa fa-check"></i><b>15.1</b> Functions as Function Inputs in R</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="functional-programming.html"><a href="functional-programming.html#sapply-and-vapply"><i class="fa fa-check"></i><b>15.1.1</b> <code>sapply()</code> and <code>vapply()</code></a></li>
<li class="chapter" data-level="15.1.2" data-path="functional-programming.html"><a href="functional-programming.html#lapply"><i class="fa fa-check"></i><b>15.1.2</b> <code>lapply()</code></a></li>
<li class="chapter" data-level="15.1.3" data-path="functional-programming.html"><a href="functional-programming.html#apply"><i class="fa fa-check"></i><b>15.1.3</b> <code>apply()</code></a></li>
<li class="chapter" data-level="15.1.4" data-path="functional-programming.html"><a href="functional-programming.html#tapply"><i class="fa fa-check"></i><b>15.1.4</b> <code>tapply()</code></a></li>
<li class="chapter" data-level="15.1.5" data-path="functional-programming.html"><a href="functional-programming.html#mapply"><i class="fa fa-check"></i><b>15.1.5</b> <code>mapply()</code></a></li>
<li class="chapter" data-level="15.1.6" data-path="functional-programming.html"><a href="functional-programming.html#reduce-and-do.call"><i class="fa fa-check"></i><b>15.1.6</b> <code>Reduce()</code> and <code>do.call()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="functional-programming.html"><a href="functional-programming.html#another-example-in-r"><i class="fa fa-check"></i><b>15.2</b> Another Example in R</a></li>
<li class="chapter" data-level="15.3" data-path="functional-programming.html"><a href="functional-programming.html#functions-as-function-inputs-in-base-python"><i class="fa fa-check"></i><b>15.3</b> Functions as Function Inputs in Base Python</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="functional-programming.html"><a href="functional-programming.html#map"><i class="fa fa-check"></i><b>15.3.1</b> <code>map()</code></a></li>
<li class="chapter" data-level="15.3.2" data-path="functional-programming.html"><a href="functional-programming.html#filter"><i class="fa fa-check"></i><b>15.3.2</b> <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="functional-programming.html"><a href="functional-programming.html#functions-as-function-inputs-in-numpy"><i class="fa fa-check"></i><b>15.4</b> Functions as Function Inputs in Numpy</a></li>
<li class="chapter" data-level="15.5" data-path="functional-programming.html"><a href="functional-programming.html#functional-methods-in-pandas"><i class="fa fa-check"></i><b>15.5</b> Functional Methods in Pandas</a></li>
<li class="chapter" data-level="15.6" data-path="functional-programming.html"><a href="functional-programming.html#functions-as-function-inputs-miscellany"><i class="fa fa-check"></i><b>15.6</b> Functions as Function Inputs (miscellany)</a></li>
<li class="chapter" data-level="15.7" data-path="functional-programming.html"><a href="functional-programming.html#functions-as-function-outputs-in-r"><i class="fa fa-check"></i><b>15.7</b> Functions as Function Outputs in R</a></li>
<li class="chapter" data-level="15.8" data-path="functional-programming.html"><a href="functional-programming.html#functions-as-function-outputs-in-python"><i class="fa fa-check"></i><b>15.8</b> Functions as Function Outputs in Python</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to R and Python For Data Analysis: A Side By Side Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reshaping-and-combining-data-sets" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Reshaping and Combining Data Sets</h1>
<div id="ordering-and-sorting-data" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Ordering and Sorting Data</h2>
<p>Sorting a data set, in ascending order, say, is a common task. You might need to do it because</p>
<ol style="list-style-type: decimal">
<li>ordering and ranking is commonly done in <em>nonparametric statistics</em>,</li>
<li>you want to inspect the most “extreme” observations in a data set,</li>
<li>it’s a pre-processing step before generating visualizations.</li>
</ol>
<p>In R, it all starts with <code>vector</code>s. There are two common functions you should know: <code>sort()</code> and <code>order()</code>. <code>sort()</code> returns the sorted <em>data</em>, while <code>order()</code> returns the <em>order indexes</em>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="reshaping-and-combining-data-sets.html#cb1-1" aria-hidden="true" tabindex="-1"></a>sillyData <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb1-2"><a href="reshaping-and-combining-data-sets.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sillyData)</span>
<span id="cb1-3"><a href="reshaping-and-combining-data-sets.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.1693271 -2.0247190 -0.6156624  0.8463154  0.5502179</span></span>
<span id="cb1-4"><a href="reshaping-and-combining-data-sets.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(sillyData)</span>
<span id="cb1-5"><a href="reshaping-and-combining-data-sets.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -2.0247190 -0.6156624 -0.1693271  0.5502179  0.8463154</span></span>
<span id="cb1-6"><a href="reshaping-and-combining-data-sets.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>(sillyData)</span>
<span id="cb1-7"><a href="reshaping-and-combining-data-sets.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2 3 1 5 4</span></span></code></pre></div>
<p><code>order()</code> is useful if you’re sorting a data frame by a particularly column. Below, we inspect the top 5 most expensive cars. Notice that we need to clean up the <code>MSRP</code> (a <code>character</code> vector) a little first. We use the function <code>gsub()</code> to find patterns in the text, and replace them with the empty string.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="reshaping-and-combining-data-sets.html#cb2-1" aria-hidden="true" tabindex="-1"></a>carData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/cars.csv&quot;</span>)</span>
<span id="cb2-2"><a href="reshaping-and-combining-data-sets.html#cb2-2" aria-hidden="true" tabindex="-1"></a>noDollarSignMSRP <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;$&quot;</span>, <span class="st">&quot;&quot;</span>, carData<span class="sc">$</span>MSRP, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="reshaping-and-combining-data-sets.html#cb2-3" aria-hidden="true" tabindex="-1"></a>carData<span class="sc">$</span>cleanMSRP <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, noDollarSignMSRP, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-4"><a href="reshaping-and-combining-data-sets.html#cb2-4" aria-hidden="true" tabindex="-1"></a>rowIndices <span class="ot">&lt;-</span> <span class="fu">order</span>(carData<span class="sc">$</span>cleanMSRP, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb2-5"><a href="reshaping-and-combining-data-sets.html#cb2-5" aria-hidden="true" tabindex="-1"></a>carData[rowIndices,<span class="fu">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;MSRP&quot;</span>, <span class="st">&quot;cleanMSRP&quot;</span>)]</span></code></pre></div>
<pre><code>##              Make                 Model     MSRP cleanMSRP
## 335       Porsche           911 GT2 2dr $192,465    192465
## 263 Mercedes-Benz             CL600 2dr $128,420    128420
## 272 Mercedes-Benz SL600 convertible 2dr $126,670    126670
## 271 Mercedes-Benz          SL55 AMG 2dr $121,770    121770
## 262 Mercedes-Benz             CL500 2dr  $94,820     94820</code></pre>
<p>In Python, Numpy has <a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html"><code>np.argsort()</code></a> and <a href="https://numpy.org/doc/stable/reference/generated/numpy.sort.html"><code>np.sort()</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="reshaping-and-combining-data-sets.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="reshaping-and-combining-data-sets.html#cb4-2" aria-hidden="true" tabindex="-1"></a>silly_data <span class="op">=</span> np.random.normal(size<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb4-3"><a href="reshaping-and-combining-data-sets.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(silly_data)</span>
<span id="cb4-4"><a href="reshaping-and-combining-data-sets.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">## [ 7.81504484e-04 -8.49078814e-01  6.21304393e-01 -1.76167440e+00</span></span>
<span id="cb4-5"><a href="reshaping-and-combining-data-sets.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">##  -1.37068606e-01]</span></span>
<span id="cb4-6"><a href="reshaping-and-combining-data-sets.html#cb4-6" aria-hidden="true" tabindex="-1"></a>np.sort(silly_data)</span>
<span id="cb4-7"><a href="reshaping-and-combining-data-sets.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">## array([-1.76167440e+00, -8.49078814e-01, -1.37068606e-01,  7.81504484e-04,</span></span>
<span id="cb4-8"><a href="reshaping-and-combining-data-sets.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">##         6.21304393e-01])</span></span>
<span id="cb4-9"><a href="reshaping-and-combining-data-sets.html#cb4-9" aria-hidden="true" tabindex="-1"></a>np.argsort(silly_data)</span>
<span id="cb4-10"><a href="reshaping-and-combining-data-sets.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">## array([3, 1, 4, 0, 2])</span></span></code></pre></div>
<p>For Pandas’ <code>DataFrame</code>s, most of the functions I find useful are methods attached to the <code>DataFrame</code> class. That means that, as long as something is inside a <code>DataFrame</code>, you can use dot notation.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="reshaping-and-combining-data-sets.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="reshaping-and-combining-data-sets.html#cb5-2" aria-hidden="true" tabindex="-1"></a>car_data <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/cars.csv&quot;</span>)</span>
<span id="cb5-3"><a href="reshaping-and-combining-data-sets.html#cb5-3" aria-hidden="true" tabindex="-1"></a>car_data[<span class="st">&#39;no_dlr_msrp&#39;</span>] <span class="op">=</span> car_data[<span class="st">&#39;MSRP&#39;</span>].<span class="bu">str</span>.replace(<span class="st">&quot;$&quot;</span>, <span class="st">&quot;&quot;</span>, regex <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb5-4"><a href="reshaping-and-combining-data-sets.html#cb5-4" aria-hidden="true" tabindex="-1"></a>car_data[<span class="st">&#39;clean_MSRP&#39;</span>] <span class="op">=</span> car_data[<span class="st">&#39;no_dlr_msrp&#39;</span>].<span class="bu">str</span>.replace(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>).astype(<span class="bu">float</span>)</span>
<span id="cb5-5"><a href="reshaping-and-combining-data-sets.html#cb5-5" aria-hidden="true" tabindex="-1"></a>car_data <span class="op">=</span> car_data.sort_values(by<span class="op">=</span><span class="st">&#39;clean_MSRP&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb5-6"><a href="reshaping-and-combining-data-sets.html#cb5-6" aria-hidden="true" tabindex="-1"></a>car_data[[<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;MSRP&quot;</span>, <span class="st">&quot;clean_MSRP&quot;</span>]].head(<span class="dv">5</span>)</span>
<span id="cb5-7"><a href="reshaping-and-combining-data-sets.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">##               Make                  Model      MSRP  clean_MSRP</span></span>
<span id="cb5-8"><a href="reshaping-and-combining-data-sets.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 334        Porsche            911 GT2 2dr  $192,465    192465.0</span></span>
<span id="cb5-9"><a href="reshaping-and-combining-data-sets.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 262  Mercedes-Benz              CL600 2dr  $128,420    128420.0</span></span>
<span id="cb5-10"><a href="reshaping-and-combining-data-sets.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 271  Mercedes-Benz  SL600 convertible 2dr  $126,670    126670.0</span></span>
<span id="cb5-11"><a href="reshaping-and-combining-data-sets.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 270  Mercedes-Benz           SL55 AMG 2dr  $121,770    121770.0</span></span>
<span id="cb5-12"><a href="reshaping-and-combining-data-sets.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">## 261  Mercedes-Benz              CL500 2dr   $94,820     94820.0</span></span></code></pre></div>
<p>Pandas’ <code>DataFrame</code>s and <code>Series</code> have a <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.replace.html"><code>.replace()</code></a> method. We use this to remove dollar signs and commas from the MSRP column. Note that we had to access the <code>.str</code> attribute of the <code>Series</code> column before we used it. After the string was processed, we converted it to a <code>Series</code> of <code>float</code>s with the <code>astype()</code> method.</p>
<p>Finally, sorting the overall data frame could have been done with the same approach as the code we used in R (i.e. raw subsetting by row indexes), but there is a built-in method called <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html"><code>sort_values()</code></a> that will do it for us.</p>
</div>
<div id="stacking-data-sets-and-placing-them-shoulder-to-shoulder" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Stacking Data Sets and Placing Them Shoulder to Shoulder</h2>
<p>Stacking data sets on top of each other is a common task. You might need to do it if</p>
<ol style="list-style-type: decimal">
<li>you need to add new a new row (or many rows) to a data frame,</li>
<li>you need to recombine data sets (e.g. recombine a train/test split), or</li>
<li>you’re creating a matrix in a step-by-step way.</li>
</ol>
<p>In R, this can be done with <code>rbind()</code> (short for “row bind”)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="reshaping-and-combining-data-sets.html#cb6-1" aria-hidden="true" tabindex="-1"></a>realEstate <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/albemarle_real_estate.csv&quot;</span>)</span>
<span id="cb6-2"><a href="reshaping-and-combining-data-sets.html#cb6-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> realEstate[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb6-3"><a href="reshaping-and-combining-data-sets.html#cb6-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> realEstate[<span class="dv">1</span>,]</span>
<span id="cb6-4"><a href="reshaping-and-combining-data-sets.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rbind</span>(test, train))</span>
<span id="cb6-5"><a href="reshaping-and-combining-data-sets.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   YearBuilt YearRemodeled Condition NumStories FinSqFt Bedroom FullBath</span></span>
<span id="cb6-6"><a href="reshaping-and-combining-data-sets.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1      2006             0   Average       1.00    1922       3        3</span></span>
<span id="cb6-7"><a href="reshaping-and-combining-data-sets.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2      2003             0   Average       1.00    1848       3        2</span></span>
<span id="cb6-8"><a href="reshaping-and-combining-data-sets.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      1972             0   Average       1.00    1248       2        1</span></span>
<span id="cb6-9"><a href="reshaping-and-combining-data-sets.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4      1998             0      Good       1.00    1244       1        1</span></span>
<span id="cb6-10"><a href="reshaping-and-combining-data-sets.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 5      1886             0   Average       1.86    1861       4        1</span></span>
<span id="cb6-11"><a href="reshaping-and-combining-data-sets.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 6      1910             0      Fair       1.53    1108       3        1</span></span>
<span id="cb6-12"><a href="reshaping-and-combining-data-sets.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   HalfBath TotalRooms LotSize TotalValue        City</span></span>
<span id="cb6-13"><a href="reshaping-and-combining-data-sets.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1        0         10   5.000     409900      CROZET</span></span>
<span id="cb6-14"><a href="reshaping-and-combining-data-sets.html#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        0          7  61.189     523100      CROZET</span></span>
<span id="cb6-15"><a href="reshaping-and-combining-data-sets.html#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3        0          4   1.760     180900 EARLYSVILLE</span></span>
<span id="cb6-16"><a href="reshaping-and-combining-data-sets.html#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 4        0          3  50.648     620700      CROZET</span></span>
<span id="cb6-17"><a href="reshaping-and-combining-data-sets.html#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 5        0          6   3.880     162500      CROZET</span></span>
<span id="cb6-18"><a href="reshaping-and-combining-data-sets.html#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 6        0          6   8.838     167200      CROZET</span></span>
<span id="cb6-19"><a href="reshaping-and-combining-data-sets.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">rbind</span>(test, train) <span class="sc">!=</span> realEstate)</span>
<span id="cb6-20"><a href="reshaping-and-combining-data-sets.html#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span></code></pre></div>
<p>The above example was with <code>data.frame</code>s. This example of <code>rbind()</code> is with <code>matrix</code> objects.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="reshaping-and-combining-data-sets.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>), </span>
<span id="cb7-2"><a href="reshaping-and-combining-data-sets.html#cb7-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="dv">2</span>,<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb7-3"><a href="reshaping-and-combining-data-sets.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3]</span></span>
<span id="cb7-4"><a href="reshaping-and-combining-data-sets.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    1    1    1</span></span>
<span id="cb7-5"><a href="reshaping-and-combining-data-sets.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    1    1    1</span></span>
<span id="cb7-6"><a href="reshaping-and-combining-data-sets.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    2    2    2</span></span>
<span id="cb7-7"><a href="reshaping-and-combining-data-sets.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,]    2    2    2</span></span></code></pre></div>
<p>In Python, you can stack data frames with <a href="https://www.google.com/search?client=safari&amp;rls=en&amp;q=pandas+concat&amp;ie=UTF-8&amp;oe=UTF-8"><code>pd.concat()</code></a>. It has a lot of options, so feel free to peruse those. You can also replace the call to <code>pd.concat()</code> below with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.append.html"><code>test.append(train)</code></a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="reshaping-and-combining-data-sets.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="reshaping-and-combining-data-sets.html#cb8-2" aria-hidden="true" tabindex="-1"></a>real_estate <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/albemarle_real_estate.csv&quot;</span>)</span>
<span id="cb8-3"><a href="reshaping-and-combining-data-sets.html#cb8-3" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> real_estate.iloc[<span class="dv">1</span>:,]</span>
<span id="cb8-4"><a href="reshaping-and-combining-data-sets.html#cb8-4" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> real_estate.iloc[[<span class="dv">0</span>],] <span class="co"># need the extra brackets!</span></span>
<span id="cb8-5"><a href="reshaping-and-combining-data-sets.html#cb8-5" aria-hidden="true" tabindex="-1"></a>pd.concat([test,train], axis<span class="op">=</span><span class="dv">0</span>).head() <span class="co"># also </span></span>
<span id="cb8-6"><a href="reshaping-and-combining-data-sets.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">##    YearBuilt  YearRemodeled Condition  ...  LotSize  TotalValue         City</span></span>
<span id="cb8-7"><a href="reshaping-and-combining-data-sets.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 0       2006              0   Average  ...    5.000      409900       CROZET</span></span>
<span id="cb8-8"><a href="reshaping-and-combining-data-sets.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 1       2003              0   Average  ...   61.189      523100       CROZET</span></span>
<span id="cb8-9"><a href="reshaping-and-combining-data-sets.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 2       1972              0   Average  ...    1.760      180900  EARLYSVILLE</span></span>
<span id="cb8-10"><a href="reshaping-and-combining-data-sets.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 3       1998              0      Good  ...   50.648      620700       CROZET</span></span>
<span id="cb8-11"><a href="reshaping-and-combining-data-sets.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 4       1886              0   Average  ...    3.880      162500       CROZET</span></span>
<span id="cb8-12"><a href="reshaping-and-combining-data-sets.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb8-13"><a href="reshaping-and-combining-data-sets.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">## [5 rows x 12 columns]</span></span>
<span id="cb8-14"><a href="reshaping-and-combining-data-sets.html#cb8-14" aria-hidden="true" tabindex="-1"></a>(pd.concat([test,train], axis<span class="op">=</span><span class="dv">0</span>) <span class="op">!=</span> real_estate).<span class="bu">sum</span>().<span class="bu">sum</span>()</span>
<span id="cb8-15"><a href="reshaping-and-combining-data-sets.html#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">## 0</span></span></code></pre></div>
<p>Take note of the extra square brackets when we create <code>test</code>. If you use <code>real_estate.iloc[0,]</code> instead, it will return a <code>Series</code> with all the elements coerced to the same type, and this won’t <code>pd.concat()</code> properly with the rest of the data!</p>
</div>
<div id="merging-or-joining-data-sets" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Merging or Joining Data Sets</h2>
<p>If you have two different data sets that provide different information about the same things, you put them together using a <strong><code>merge</code></strong> (aka <strong><code>join</code></strong>) statement. The resulting data set is wider, and it may end up with either more or fewer rows. In R, you can use the <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/merge"><code>merge()</code> function</a>. In Python, you can use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html#pandas-dataframe-merge"><code>.merge()</code> method</a>.</p>
<p>Suppose you have to sets of supposedly anonymized data about individual accounts on some online platforms.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="reshaping-and-combining-data-sets.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in R</span></span>
<span id="cb9-2"><a href="reshaping-and-combining-data-sets.html#cb9-2" aria-hidden="true" tabindex="-1"></a>baby1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/baby1.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-3"><a href="reshaping-and-combining-data-sets.html#cb9-3" aria-hidden="true" tabindex="-1"></a>baby2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/baby2.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-4"><a href="reshaping-and-combining-data-sets.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(baby1)</span>
<span id="cb9-5"><a href="reshaping-and-combining-data-sets.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   idnum height.inches.          email_address</span></span>
<span id="cb9-6"><a href="reshaping-and-combining-data-sets.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1             74 fakeemail123@gmail.com</span></span>
<span id="cb9-7"><a href="reshaping-and-combining-data-sets.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     3             66  anotherfake@gmail.com</span></span>
<span id="cb9-8"><a href="reshaping-and-combining-data-sets.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     4             62      notreal@gmail.com</span></span>
<span id="cb9-9"><a href="reshaping-and-combining-data-sets.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    23             62      notreal@gmail.com</span></span>
<span id="cb9-10"><a href="reshaping-and-combining-data-sets.html#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(baby2)</span>
<span id="cb9-11"><a href="reshaping-and-combining-data-sets.html#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     idnum      phone                   email</span></span>
<span id="cb9-12"><a href="reshaping-and-combining-data-sets.html#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 3901283 5051234567       notreal@gmail.com</span></span>
<span id="cb9-13"><a href="reshaping-and-combining-data-sets.html#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2   41823 5051234568 notrealeither@gmail.com</span></span>
<span id="cb9-14"><a href="reshaping-and-combining-data-sets.html#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 7198273 5051234568   anotherfake@gmail.com</span></span></code></pre></div>
<p>The first thing you need to ask yourself is <em>“which column is the unique identifier that is shared between these two data sets?”</em> In our case, they both have an “identification number” column. However, these two data sets are coming from different online platforms, and these two places use different schemes to number their users.</p>
<p>In this case, it is better to merge on the email addresses. Users might be using different email addresses on these two platforms, but there’s a stronger guarantee that matched email addresses means that you’re matching the right accounts. The columns are named differently in each data set, so we must specify them by name.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="reshaping-and-combining-data-sets.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in R</span></span>
<span id="cb10-2"><a href="reshaping-and-combining-data-sets.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(baby1, baby2, <span class="at">by.x =</span> <span class="st">&quot;email_address&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;email&quot;</span>)</span>
<span id="cb10-3"><a href="reshaping-and-combining-data-sets.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">##           email_address idnum.x height.inches. idnum.y      phone</span></span>
<span id="cb10-4"><a href="reshaping-and-combining-data-sets.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 anotherfake@gmail.com       3             66 7198273 5051234568</span></span>
<span id="cb10-5"><a href="reshaping-and-combining-data-sets.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     notreal@gmail.com       4             62 3901283 5051234567</span></span>
<span id="cb10-6"><a href="reshaping-and-combining-data-sets.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     notreal@gmail.com      23             62 3901283 5051234567</span></span></code></pre></div>
<p>In Python, <code>merge()</code> is a method attached to each <code>DataFrame</code> instance.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="reshaping-and-combining-data-sets.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in Python</span></span>
<span id="cb11-2"><a href="reshaping-and-combining-data-sets.html#cb11-2" aria-hidden="true" tabindex="-1"></a>baby1.merge(baby2, left_on <span class="op">=</span> <span class="st">&quot;email_address&quot;</span>, right_on <span class="op">=</span> <span class="st">&quot;email&quot;</span>)</span>
<span id="cb11-3"><a href="reshaping-and-combining-data-sets.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">##    idnum_x  height(inches)  ...       phone                  email</span></span>
<span id="cb11-4"><a href="reshaping-and-combining-data-sets.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">## 0        3              66  ...  5051234568  anotherfake@gmail.com</span></span>
<span id="cb11-5"><a href="reshaping-and-combining-data-sets.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">## 1        4              62  ...  5051234567      notreal@gmail.com</span></span>
<span id="cb11-6"><a href="reshaping-and-combining-data-sets.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 2       23              62  ...  5051234567      notreal@gmail.com</span></span>
<span id="cb11-7"><a href="reshaping-and-combining-data-sets.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb11-8"><a href="reshaping-and-combining-data-sets.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">## [3 rows x 6 columns]</span></span></code></pre></div>
<p>The email addresses <code>anotherfake@gmail.com</code> and <code>notreal@gmail.com</code> exist in both data sets, so each of these email addresses will end up in the result data frame. The rows in the result data set are wider and have more attributes for each individual.</p>
<p>Notice the duplicate email address, too. In this case, either the user signed up for two accounts using the same email, or one person signed up for an account with another person’s email address. In the case of duplicates, both rows will match with the same rows in the other data frame.</p>
<p>Also, in this case, all email addresses that weren’t found in both data sets were thrown away. This does not necessarily need to be the intended behavior. For instance, if we wanted to make sure no rows were thrown away, that would be possible. In this case, though, for email addresses that weren’t found in both data sets, some information will be missing. Recall that Python and R handle missing data differently (see <a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#how-r-and-python-handle-missing-values">2.8.2</a>).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="reshaping-and-combining-data-sets.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in R</span></span>
<span id="cb12-2"><a href="reshaping-and-combining-data-sets.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(baby1, baby2, </span>
<span id="cb12-3"><a href="reshaping-and-combining-data-sets.html#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">by.x =</span> <span class="st">&quot;email_address&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;email&quot;</span>, </span>
<span id="cb12-4"><a href="reshaping-and-combining-data-sets.html#cb12-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-5"><a href="reshaping-and-combining-data-sets.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">##             email_address idnum.x height.inches. idnum.y      phone</span></span>
<span id="cb12-6"><a href="reshaping-and-combining-data-sets.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   anotherfake@gmail.com       3             66 7198273 5051234568</span></span>
<span id="cb12-7"><a href="reshaping-and-combining-data-sets.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  fakeemail123@gmail.com       1             74      NA         NA</span></span>
<span id="cb12-8"><a href="reshaping-and-combining-data-sets.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3       notreal@gmail.com       4             62 3901283 5051234567</span></span>
<span id="cb12-9"><a href="reshaping-and-combining-data-sets.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4       notreal@gmail.com      23             62 3901283 5051234567</span></span>
<span id="cb12-10"><a href="reshaping-and-combining-data-sets.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 notrealeither@gmail.com      NA             NA   41823 5051234568</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="reshaping-and-combining-data-sets.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in Python</span></span>
<span id="cb13-2"><a href="reshaping-and-combining-data-sets.html#cb13-2" aria-hidden="true" tabindex="-1"></a>baby1.merge(baby2, </span>
<span id="cb13-3"><a href="reshaping-and-combining-data-sets.html#cb13-3" aria-hidden="true" tabindex="-1"></a>            left_on <span class="op">=</span> <span class="st">&quot;email_address&quot;</span>, right_on <span class="op">=</span> <span class="st">&quot;email&quot;</span>, </span>
<span id="cb13-4"><a href="reshaping-and-combining-data-sets.html#cb13-4" aria-hidden="true" tabindex="-1"></a>            how <span class="op">=</span> <span class="st">&quot;outer&quot;</span>)</span>
<span id="cb13-5"><a href="reshaping-and-combining-data-sets.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">##    idnum_x  height(inches)  ...         phone                    email</span></span>
<span id="cb13-6"><a href="reshaping-and-combining-data-sets.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 0      1.0            74.0  ...           NaN                      NaN</span></span>
<span id="cb13-7"><a href="reshaping-and-combining-data-sets.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 1      3.0            66.0  ...  5.051235e+09    anotherfake@gmail.com</span></span>
<span id="cb13-8"><a href="reshaping-and-combining-data-sets.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 2      4.0            62.0  ...  5.051235e+09        notreal@gmail.com</span></span>
<span id="cb13-9"><a href="reshaping-and-combining-data-sets.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 3     23.0            62.0  ...  5.051235e+09        notreal@gmail.com</span></span>
<span id="cb13-10"><a href="reshaping-and-combining-data-sets.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 4      NaN             NaN  ...  5.051235e+09  notrealeither@gmail.com</span></span>
<span id="cb13-11"><a href="reshaping-and-combining-data-sets.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb13-12"><a href="reshaping-and-combining-data-sets.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">## [5 rows x 6 columns]</span></span></code></pre></div>
<p>You can see it’s slightly more concise in Python. If you are familiar with SQL, you might have heard of inner and outer joins. This is where pandas <a href="https://pandas.pydata.org/pandas-docs/version/0.15/merging.html#database-style-dataframe-joining-merging">takes some of its argument names from</a>.</p>
<p>Finally, if both data sets have multiple values in the column you’re joining on, the result can have more rows than either table. This is because <em>every possible match</em> shows up.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="reshaping-and-combining-data-sets.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in R</span></span>
<span id="cb14-2"><a href="reshaping-and-combining-data-sets.html#cb14-2" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">category =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;a&#39;</span>), <span class="at">measurement =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb14-3"><a href="reshaping-and-combining-data-sets.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(first, first, <span class="at">by.x =</span> <span class="st">&quot;category&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;category&quot;</span>)</span>
<span id="cb14-4"><a href="reshaping-and-combining-data-sets.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   category measurement.x measurement.y</span></span>
<span id="cb14-5"><a href="reshaping-and-combining-data-sets.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1        a             1             1</span></span>
<span id="cb14-6"><a href="reshaping-and-combining-data-sets.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        a             1             2</span></span>
<span id="cb14-7"><a href="reshaping-and-combining-data-sets.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3        a             2             1</span></span>
<span id="cb14-8"><a href="reshaping-and-combining-data-sets.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 4        a             2             2</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="reshaping-and-combining-data-sets.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in Python</span></span>
<span id="cb15-2"><a href="reshaping-and-combining-data-sets.html#cb15-2" aria-hidden="true" tabindex="-1"></a>first <span class="op">=</span> pd.DataFrame({<span class="st">&#39;category&#39;</span> : [<span class="st">&#39;a&#39;</span>,<span class="st">&#39;a&#39;</span>], <span class="st">&#39;measurement&#39;</span> : [<span class="dv">1</span>,<span class="dv">2</span>]})</span>
<span id="cb15-3"><a href="reshaping-and-combining-data-sets.html#cb15-3" aria-hidden="true" tabindex="-1"></a>first.merge(first, left_on <span class="op">=</span> <span class="st">&quot;category&quot;</span>, right_on <span class="op">=</span> <span class="st">&quot;category&quot;</span>)</span>
<span id="cb15-4"><a href="reshaping-and-combining-data-sets.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">##   category  measurement_x  measurement_y</span></span>
<span id="cb15-5"><a href="reshaping-and-combining-data-sets.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">## 0        a              1              1</span></span>
<span id="cb15-6"><a href="reshaping-and-combining-data-sets.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 1        a              1              2</span></span>
<span id="cb15-7"><a href="reshaping-and-combining-data-sets.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 2        a              2              1</span></span>
<span id="cb15-8"><a href="reshaping-and-combining-data-sets.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 3        a              2              2</span></span></code></pre></div>
</div>
<div id="long-versus-wide-data" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Long Versus Wide Data</h2>
<div id="long-versus-wide-in-r" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Long Versus Wide in R</h3>
<p>Many types of data can be stored in either a <strong>wide</strong> or <strong>long</strong> format.</p>
<p>The classical example is data from a <em>longitudinal study.</em> If an experimental unit (in the example below this is a person) is repeatedly measured over time, each row would correspond to an experimental unit <em>and</em> an observation time in a data set in a long form.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="reshaping-and-combining-data-sets.html#cb16-1" aria-hidden="true" tabindex="-1"></a>fakeLongData1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">person =</span> <span class="fu">c</span>(<span class="st">&quot;Taylor&quot;</span>,<span class="st">&quot;Taylor&quot;</span>,<span class="st">&quot;Charlie&quot;</span>,<span class="st">&quot;Charlie&quot;</span>), </span>
<span id="cb16-2"><a href="reshaping-and-combining-data-sets.html#cb16-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">timeObserved =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb16-3"><a href="reshaping-and-combining-data-sets.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nums =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">101</span>,<span class="dv">300</span>,<span class="dv">301</span>))</span>
<span id="cb16-4"><a href="reshaping-and-combining-data-sets.html#cb16-4" aria-hidden="true" tabindex="-1"></a>fakeLongData1</span>
<span id="cb16-5"><a href="reshaping-and-combining-data-sets.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    person timeObserved nums</span></span>
<span id="cb16-6"><a href="reshaping-and-combining-data-sets.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor            1  100</span></span>
<span id="cb16-7"><a href="reshaping-and-combining-data-sets.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  Taylor            2  101</span></span>
<span id="cb16-8"><a href="reshaping-and-combining-data-sets.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie            1  300</span></span>
<span id="cb16-9"><a href="reshaping-and-combining-data-sets.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Charlie            2  301</span></span></code></pre></div>
<p>A long format can also be used if you have multiple observations (at a single time point) on an experimental unit. Here is another example.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="reshaping-and-combining-data-sets.html#cb17-1" aria-hidden="true" tabindex="-1"></a>fakeLongData2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">person =</span> <span class="fu">c</span>(<span class="st">&quot;Taylor&quot;</span>, <span class="st">&quot;Taylor&quot;</span>, <span class="st">&quot;Charlie&quot;</span>,<span class="st">&quot;Charlie&quot;</span>), </span>
<span id="cb17-2"><a href="reshaping-and-combining-data-sets.html#cb17-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">attributeName =</span> <span class="fu">c</span>(<span class="st">&quot;attrA&quot;</span>,<span class="st">&quot;attrB&quot;</span>,<span class="st">&quot;attrA&quot;</span>,<span class="st">&quot;attrB&quot;</span>),</span>
<span id="cb17-3"><a href="reshaping-and-combining-data-sets.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nums =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">101</span>,<span class="dv">300</span>,<span class="dv">301</span>))</span>
<span id="cb17-4"><a href="reshaping-and-combining-data-sets.html#cb17-4" aria-hidden="true" tabindex="-1"></a>fakeLongData2</span>
<span id="cb17-5"><a href="reshaping-and-combining-data-sets.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    person attributeName nums</span></span>
<span id="cb17-6"><a href="reshaping-and-combining-data-sets.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor         attrA  100</span></span>
<span id="cb17-7"><a href="reshaping-and-combining-data-sets.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  Taylor         attrB  101</span></span>
<span id="cb17-8"><a href="reshaping-and-combining-data-sets.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie         attrA  300</span></span>
<span id="cb17-9"><a href="reshaping-and-combining-data-sets.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Charlie         attrB  301</span></span></code></pre></div>
<p>If you would like to reshape the long data sets into a wide format, you can use the <code>reshape()</code> function. You will need to specify which columns correspond with the experimental unit, and which column is the “factor” variable.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="reshaping-and-combining-data-sets.html#cb18-1" aria-hidden="true" tabindex="-1"></a>fakeWideData1 <span class="ot">&lt;-</span> <span class="fu">reshape</span>(fakeLongData1, </span>
<span id="cb18-2"><a href="reshaping-and-combining-data-sets.html#cb18-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">direction =</span> <span class="st">&quot;wide&quot;</span>, </span>
<span id="cb18-3"><a href="reshaping-and-combining-data-sets.html#cb18-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">timevar =</span> <span class="st">&quot;timeObserved&quot;</span>, </span>
<span id="cb18-4"><a href="reshaping-and-combining-data-sets.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">idvar =</span> <span class="st">&quot;person&quot;</span>, </span>
<span id="cb18-5"><a href="reshaping-and-combining-data-sets.html#cb18-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;after&quot;</span>)) <span class="co"># col names in new data set</span></span>
<span id="cb18-6"><a href="reshaping-and-combining-data-sets.html#cb18-6" aria-hidden="true" tabindex="-1"></a>fakeLongData1</span>
<span id="cb18-7"><a href="reshaping-and-combining-data-sets.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    person timeObserved nums</span></span>
<span id="cb18-8"><a href="reshaping-and-combining-data-sets.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor            1  100</span></span>
<span id="cb18-9"><a href="reshaping-and-combining-data-sets.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  Taylor            2  101</span></span>
<span id="cb18-10"><a href="reshaping-and-combining-data-sets.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie            1  300</span></span>
<span id="cb18-11"><a href="reshaping-and-combining-data-sets.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Charlie            2  301</span></span>
<span id="cb18-12"><a href="reshaping-and-combining-data-sets.html#cb18-12" aria-hidden="true" tabindex="-1"></a>fakeWideData1</span>
<span id="cb18-13"><a href="reshaping-and-combining-data-sets.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="do">##    person before after</span></span>
<span id="cb18-14"><a href="reshaping-and-combining-data-sets.html#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor    100   101</span></span>
<span id="cb18-15"><a href="reshaping-and-combining-data-sets.html#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie    300   301</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="reshaping-and-combining-data-sets.html#cb19-1" aria-hidden="true" tabindex="-1"></a>fakeWideData2 <span class="ot">&lt;-</span> <span class="fu">reshape</span>(fakeLongData2, </span>
<span id="cb19-2"><a href="reshaping-and-combining-data-sets.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">direction =</span> <span class="st">&quot;wide&quot;</span>, </span>
<span id="cb19-3"><a href="reshaping-and-combining-data-sets.html#cb19-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">timevar =</span> <span class="st">&quot;attributeName&quot;</span>, <span class="co"># timevar is a misnomer here</span></span>
<span id="cb19-4"><a href="reshaping-and-combining-data-sets.html#cb19-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">idvar =</span> <span class="st">&quot;person&quot;</span>, </span>
<span id="cb19-5"><a href="reshaping-and-combining-data-sets.html#cb19-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">&quot;attribute A&quot;</span>,<span class="st">&quot;attribute B&quot;</span>)) </span>
<span id="cb19-6"><a href="reshaping-and-combining-data-sets.html#cb19-6" aria-hidden="true" tabindex="-1"></a>fakeLongData2</span>
<span id="cb19-7"><a href="reshaping-and-combining-data-sets.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    person attributeName nums</span></span>
<span id="cb19-8"><a href="reshaping-and-combining-data-sets.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor         attrA  100</span></span>
<span id="cb19-9"><a href="reshaping-and-combining-data-sets.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  Taylor         attrB  101</span></span>
<span id="cb19-10"><a href="reshaping-and-combining-data-sets.html#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie         attrA  300</span></span>
<span id="cb19-11"><a href="reshaping-and-combining-data-sets.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Charlie         attrB  301</span></span>
<span id="cb19-12"><a href="reshaping-and-combining-data-sets.html#cb19-12" aria-hidden="true" tabindex="-1"></a>fakeWideData2</span>
<span id="cb19-13"><a href="reshaping-and-combining-data-sets.html#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="do">##    person attribute A attribute B</span></span>
<span id="cb19-14"><a href="reshaping-and-combining-data-sets.html#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor         100         101</span></span>
<span id="cb19-15"><a href="reshaping-and-combining-data-sets.html#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie         300         301</span></span></code></pre></div>
<p><code>reshape()</code> will also go in the other direction: it can take wide data and convert it into long data</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="reshaping-and-combining-data-sets.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(fakeWideData1, </span>
<span id="cb20-2"><a href="reshaping-and-combining-data-sets.html#cb20-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">&quot;long&quot;</span>,</span>
<span id="cb20-3"><a href="reshaping-and-combining-data-sets.html#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">idvar =</span> <span class="st">&quot;person&quot;</span>, </span>
<span id="cb20-4"><a href="reshaping-and-combining-data-sets.html#cb20-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">varying =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;before&quot;</span>,<span class="st">&quot;after&quot;</span>)),</span>
<span id="cb20-5"><a href="reshaping-and-combining-data-sets.html#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.names =</span> <span class="st">&quot;nums&quot;</span>)</span>
<span id="cb20-6"><a href="reshaping-and-combining-data-sets.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">##            person time nums</span></span>
<span id="cb20-7"><a href="reshaping-and-combining-data-sets.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Taylor.1   Taylor    1  100</span></span>
<span id="cb20-8"><a href="reshaping-and-combining-data-sets.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Charlie.1 Charlie    1  300</span></span>
<span id="cb20-9"><a href="reshaping-and-combining-data-sets.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Taylor.2   Taylor    2  101</span></span>
<span id="cb20-10"><a href="reshaping-and-combining-data-sets.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Charlie.2 Charlie    2  301</span></span>
<span id="cb20-11"><a href="reshaping-and-combining-data-sets.html#cb20-11" aria-hidden="true" tabindex="-1"></a>fakeLongData1</span>
<span id="cb20-12"><a href="reshaping-and-combining-data-sets.html#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="do">##    person timeObserved nums</span></span>
<span id="cb20-13"><a href="reshaping-and-combining-data-sets.html#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor            1  100</span></span>
<span id="cb20-14"><a href="reshaping-and-combining-data-sets.html#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  Taylor            2  101</span></span>
<span id="cb20-15"><a href="reshaping-and-combining-data-sets.html#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie            1  300</span></span>
<span id="cb20-16"><a href="reshaping-and-combining-data-sets.html#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Charlie            2  301</span></span>
<span id="cb20-17"><a href="reshaping-and-combining-data-sets.html#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(fakeWideData2, </span>
<span id="cb20-18"><a href="reshaping-and-combining-data-sets.html#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">&quot;long&quot;</span>,</span>
<span id="cb20-19"><a href="reshaping-and-combining-data-sets.html#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">idvar =</span> <span class="st">&quot;person&quot;</span>, </span>
<span id="cb20-20"><a href="reshaping-and-combining-data-sets.html#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">varying =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;attribute A&quot;</span>,<span class="st">&quot;attribute B&quot;</span>)),</span>
<span id="cb20-21"><a href="reshaping-and-combining-data-sets.html#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.names =</span> <span class="st">&quot;nums&quot;</span>)</span>
<span id="cb20-22"><a href="reshaping-and-combining-data-sets.html#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="do">##            person time nums</span></span>
<span id="cb20-23"><a href="reshaping-and-combining-data-sets.html#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Taylor.1   Taylor    1  100</span></span>
<span id="cb20-24"><a href="reshaping-and-combining-data-sets.html#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Charlie.1 Charlie    1  300</span></span>
<span id="cb20-25"><a href="reshaping-and-combining-data-sets.html#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Taylor.2   Taylor    2  101</span></span>
<span id="cb20-26"><a href="reshaping-and-combining-data-sets.html#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Charlie.2 Charlie    2  301</span></span>
<span id="cb20-27"><a href="reshaping-and-combining-data-sets.html#cb20-27" aria-hidden="true" tabindex="-1"></a>fakeLongData2</span>
<span id="cb20-28"><a href="reshaping-and-combining-data-sets.html#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="do">##    person attributeName nums</span></span>
<span id="cb20-29"><a href="reshaping-and-combining-data-sets.html#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  Taylor         attrA  100</span></span>
<span id="cb20-30"><a href="reshaping-and-combining-data-sets.html#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  Taylor         attrB  101</span></span>
<span id="cb20-31"><a href="reshaping-and-combining-data-sets.html#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Charlie         attrA  300</span></span>
<span id="cb20-32"><a href="reshaping-and-combining-data-sets.html#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Charlie         attrB  301</span></span></code></pre></div>
</div>
<div id="long-versus-wide-in-python" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Long Versus Wide in Python</h3>
<p>With Pandas, we can take make wide data long with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot.html#"><code>pd.DataFrame.pivot()</code></a>, and we can go in the other direction with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.melt.html?highlight=melt"><code>pd.DataFrame.melt()</code></a>.</p>
<p>When going from wide to long, make sure to use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html#"><code>pd.DataFrame.reset_index()</code></a> method afterwards to reshape the data and remove the index. Here is an example similar to the one above.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="reshaping-and-combining-data-sets.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-2"><a href="reshaping-and-combining-data-sets.html#cb21-2" aria-hidden="true" tabindex="-1"></a>fake_long_data1 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb21-3"><a href="reshaping-and-combining-data-sets.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  {<span class="st">&#39;person&#39;</span> : [<span class="st">&quot;Taylor&quot;</span>,<span class="st">&quot;Taylor&quot;</span>,<span class="st">&quot;Charlie&quot;</span>,<span class="st">&quot;Charlie&quot;</span>], </span>
<span id="cb21-4"><a href="reshaping-and-combining-data-sets.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;time_observed&#39;</span> : [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb21-5"><a href="reshaping-and-combining-data-sets.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;nums&#39;</span> : [<span class="dv">100</span>,<span class="dv">101</span>,<span class="dv">300</span>,<span class="dv">301</span>]})</span>
<span id="cb21-6"><a href="reshaping-and-combining-data-sets.html#cb21-6" aria-hidden="true" tabindex="-1"></a>fake_long_data1</span>
<span id="cb21-7"><a href="reshaping-and-combining-data-sets.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">##     person  time_observed  nums</span></span>
<span id="cb21-8"><a href="reshaping-and-combining-data-sets.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 0   Taylor              1   100</span></span>
<span id="cb21-9"><a href="reshaping-and-combining-data-sets.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 1   Taylor              2   101</span></span>
<span id="cb21-10"><a href="reshaping-and-combining-data-sets.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 2  Charlie              1   300</span></span>
<span id="cb21-11"><a href="reshaping-and-combining-data-sets.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 3  Charlie              2   301</span></span>
<span id="cb21-12"><a href="reshaping-and-combining-data-sets.html#cb21-12" aria-hidden="true" tabindex="-1"></a>pivot_data1 <span class="op">=</span> fake_long_data1.pivot(index<span class="op">=</span><span class="st">&#39;person&#39;</span>, </span>
<span id="cb21-13"><a href="reshaping-and-combining-data-sets.html#cb21-13" aria-hidden="true" tabindex="-1"></a>                                    columns<span class="op">=</span><span class="st">&#39;time_observed&#39;</span>, </span>
<span id="cb21-14"><a href="reshaping-and-combining-data-sets.html#cb21-14" aria-hidden="true" tabindex="-1"></a>                                    values<span class="op">=</span><span class="st">&#39;nums&#39;</span>)</span>
<span id="cb21-15"><a href="reshaping-and-combining-data-sets.html#cb21-15" aria-hidden="true" tabindex="-1"></a>fake_wide_data1 <span class="op">=</span> pivot_data1.reset_index()</span>
<span id="cb21-16"><a href="reshaping-and-combining-data-sets.html#cb21-16" aria-hidden="true" tabindex="-1"></a>fake_wide_data1</span>
<span id="cb21-17"><a href="reshaping-and-combining-data-sets.html#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">## time_observed   person    1    2</span></span>
<span id="cb21-18"><a href="reshaping-and-combining-data-sets.html#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">## 0              Charlie  300  301</span></span>
<span id="cb21-19"><a href="reshaping-and-combining-data-sets.html#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">## 1               Taylor  100  101</span></span></code></pre></div>
<p>Here’s one more example showing the same functionality–going from wide to long format.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="reshaping-and-combining-data-sets.html#cb22-1" aria-hidden="true" tabindex="-1"></a>fake_long_data2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;person&#39;</span> : [<span class="st">&quot;Taylor&quot;</span>,<span class="st">&quot;Taylor&quot;</span>,<span class="st">&quot;Charlie&quot;</span>,<span class="st">&quot;Charlie&quot;</span>], </span>
<span id="cb22-2"><a href="reshaping-and-combining-data-sets.html#cb22-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;attribute_name&#39;</span> : [<span class="st">&#39;attrA&#39;</span>, <span class="st">&#39;attrB&#39;</span>, <span class="st">&#39;attrA&#39;</span>, <span class="st">&#39;attrB&#39;</span>],</span>
<span id="cb22-3"><a href="reshaping-and-combining-data-sets.html#cb22-3" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;nums&#39;</span> : [<span class="dv">100</span>,<span class="dv">101</span>,<span class="dv">300</span>,<span class="dv">301</span>]})</span>
<span id="cb22-4"><a href="reshaping-and-combining-data-sets.html#cb22-4" aria-hidden="true" tabindex="-1"></a>fake_wide_data2 <span class="op">=</span> fake_long_data2.pivot(index<span class="op">=</span><span class="st">&#39;person&#39;</span>, </span>
<span id="cb22-5"><a href="reshaping-and-combining-data-sets.html#cb22-5" aria-hidden="true" tabindex="-1"></a>                                        columns<span class="op">=</span><span class="st">&#39;attribute_name&#39;</span>, </span>
<span id="cb22-6"><a href="reshaping-and-combining-data-sets.html#cb22-6" aria-hidden="true" tabindex="-1"></a>                                        values<span class="op">=</span><span class="st">&#39;nums&#39;</span>).reset_index()</span>
<span id="cb22-7"><a href="reshaping-and-combining-data-sets.html#cb22-7" aria-hidden="true" tabindex="-1"></a>fake_wide_data2</span>
<span id="cb22-8"><a href="reshaping-and-combining-data-sets.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">## attribute_name   person  attrA  attrB</span></span>
<span id="cb22-9"><a href="reshaping-and-combining-data-sets.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 0               Charlie    300    301</span></span>
<span id="cb22-10"><a href="reshaping-and-combining-data-sets.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 1                Taylor    100    101</span></span></code></pre></div>
<p>Here are some examples of going in the other direction: from wide to long with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.melt.html?highlight=melt"><code>pd.DataFrame.melt()</code></a>. The first example specifies value columns by integers.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="reshaping-and-combining-data-sets.html#cb23-1" aria-hidden="true" tabindex="-1"></a>fake_wide_data1</span>
<span id="cb23-2"><a href="reshaping-and-combining-data-sets.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">## time_observed   person    1    2</span></span>
<span id="cb23-3"><a href="reshaping-and-combining-data-sets.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">## 0              Charlie  300  301</span></span>
<span id="cb23-4"><a href="reshaping-and-combining-data-sets.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">## 1               Taylor  100  101</span></span>
<span id="cb23-5"><a href="reshaping-and-combining-data-sets.html#cb23-5" aria-hidden="true" tabindex="-1"></a>fake_wide_data1.melt(id_vars <span class="op">=</span> <span class="st">&quot;person&quot;</span>, value_vars <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb23-6"><a href="reshaping-and-combining-data-sets.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">##     person time_observed  value</span></span>
<span id="cb23-7"><a href="reshaping-and-combining-data-sets.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 0  Charlie             1    300</span></span>
<span id="cb23-8"><a href="reshaping-and-combining-data-sets.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 1   Taylor             1    100</span></span>
<span id="cb23-9"><a href="reshaping-and-combining-data-sets.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 2  Charlie             2    301</span></span>
<span id="cb23-10"><a href="reshaping-and-combining-data-sets.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 3   Taylor             2    101</span></span></code></pre></div>
<p>The second example uses strings to specify value columns.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="reshaping-and-combining-data-sets.html#cb24-1" aria-hidden="true" tabindex="-1"></a>fake_wide_data2</span>
<span id="cb24-2"><a href="reshaping-and-combining-data-sets.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">## attribute_name   person  attrA  attrB</span></span>
<span id="cb24-3"><a href="reshaping-and-combining-data-sets.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">## 0               Charlie    300    301</span></span>
<span id="cb24-4"><a href="reshaping-and-combining-data-sets.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">## 1                Taylor    100    101</span></span>
<span id="cb24-5"><a href="reshaping-and-combining-data-sets.html#cb24-5" aria-hidden="true" tabindex="-1"></a>fake_wide_data2.melt(id_vars <span class="op">=</span> <span class="st">&quot;person&quot;</span>, value_vars <span class="op">=</span> [<span class="st">&#39;attrA&#39;</span>,<span class="st">&#39;attrB&#39;</span>])</span>
<span id="cb24-6"><a href="reshaping-and-combining-data-sets.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">##     person attribute_name  value</span></span>
<span id="cb24-7"><a href="reshaping-and-combining-data-sets.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 0  Charlie          attrA    300</span></span>
<span id="cb24-8"><a href="reshaping-and-combining-data-sets.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 1   Taylor          attrA    100</span></span>
<span id="cb24-9"><a href="reshaping-and-combining-data-sets.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 2  Charlie          attrB    301</span></span>
<span id="cb24-10"><a href="reshaping-and-combining-data-sets.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 3   Taylor          attrB    101</span></span></code></pre></div>
<p>TODO exercises just have them read in correctly Recall the file “<code>long-beach-va.data</code>” from <a href="https://archive.ics.uci.edu/ml/datasets/heart+disease">UCI Machine Learning Repository</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="control-flow.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tbrown122387/r_and_python_book/edit/master/12-reshaping.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
